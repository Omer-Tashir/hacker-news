<div class="login-page">
  <div class="login-container" [@fadeInOnEnter]>
    <div class="login-title-container">
      <img [src]="logo" class="logo" [routerLink]="'/home'" />
    </div>

    <form [formGroup]="formGroup" class="login-form" autocomplete="off" [class.login-form--new-user]="newUser">
      <mat-form-field>
        <span class="prefix" matPrefix>
          <mat-icon>account_circle</mat-icon>
        </span>
        <mat-label class="username">username</mat-label>
        <input
          matInput
          formControlName="username"
          autocomplete="off"
          spellcheck="false"
        />
        <mat-error *ngIf="hasError('username', 'required')">username is required</mat-error>
      </mat-form-field>

      <mat-form-field>
        <span class="prefix" matPrefix>
          <mat-icon>password</mat-icon>
        </span>
        <mat-label class="password">password</mat-label>
        <input
          matInput
          type="password"
          formControlName="password"
          autocomplete="off"
          spellcheck="false"
        />
        <mat-error *ngIf="hasError('password', 'required')">password is required</mat-error>
      </mat-form-field>

      <mat-form-field *ngIf="newUser">
        <span class="prefix" matPrefix>
          <mat-icon>person</mat-icon>
        </span>
        <mat-label class="name">name</mat-label>
        <input
          matInput
          formControlName="name"
          autocomplete="off"
          spellcheck="false"
        />
        <mat-error *ngIf="hasError('name', 'required')">name is required</mat-error>
      </mat-form-field>

      <mat-form-field *ngIf="newUser">
        <span class="prefix" matPrefix>
          <mat-icon>email</mat-icon>
        </span>
        <mat-label class="email">email</mat-label>
        <input
          matInput
          formControlName="email"
          autocomplete="off"
          spellcheck="false"
        />
        <mat-error *ngIf="hasError('email', 'required')">email is required</mat-error>
        <mat-error *ngIf="hasError('email', 'email')">email is invalid</mat-error>
      </mat-form-field>

      <mat-form-field *ngIf="newUser">
        <span class="prefix" matPrefix>
          <mat-icon>phone</mat-icon>
        </span>
        <mat-label class="phone">phone</mat-label>
        <input
          type="tel"
          matInput
          formControlName="phone"
          autocomplete="off"
          spellcheck="false"
        />
        <mat-error *ngIf="hasError('phone', 'required')">phone is required</mat-error>
      </mat-form-field>

      <mat-form-field *ngIf="newUser">
        <span class="prefix" matPrefix>
          <mat-icon>place</mat-icon>
        </span>
        <input autocomplete="new-phone" matInput type="text" placeholder="city" formControlName="city" id="city" required>
        <mat-error *ngIf="hasError('city', 'required')">city is required</mat-error>
      </mat-form-field>
  
      <div class="inner-grid" *ngIf="newUser">
        <mat-form-field>
          <span class="prefix" matPrefix>
            <mat-icon>streetview</mat-icon>
          </span>
          <input autocomplete="new-phone" matInput type="text" placeholder="street" formControlName="address" id="address" required autocomplete="new-phone">
          <mat-error *ngIf="hasError('address', 'required')">address</mat-error>
        </mat-form-field>
  
        <mat-form-field>
          <span class="prefix" matPrefix>
            <mat-icon>store</mat-icon>
          </span>
          <input autocomplete="new-phone" matInput type="number" placeholder="number" formControlName="addressNumber" id="addressNumber" required>
          <mat-error *ngIf="hasError('addressNumber', 'required')">number is required</mat-error>
        </mat-form-field>
      </div>
    </form>

    <ng-container *ngIf="newUser">
      <div class="form-field profile-image-container">
        <div class="profile-image" *ngIf="formGroup.controls['photo'].value"
          [ngStyle]="{'background-image':'url('+formGroup.controls['photo'].value+')'}"></div>
        <span>Pick an image</span>
        <input type="file" placeholder="Pick an image" (change)="onImageChange($event)" accept="image/*">
      </div>
    </ng-container>

    <div class="form-footer">
      <button
        mat-raised-button
        (click)="submit()"
        color="primary"
        [disabled]="!formGroup.valid"
      >
      <ng-container *ngIf="!newUser">login</ng-container>
      <ng-container *ngIf="newUser">register</ng-container>
      </button>

      <span *ngIf="!newUser" class="reset-password" (click)="resetPassword()">Reset my password</span>
    </div>

    <div class="sign-up">
      <span (click)="toggleNewUser()">
          <ng-container *ngIf="!newUser">new user? click here</ng-container>
          <ng-container *ngIf="newUser">already a user?</ng-container>
      </span>
  </div>
  </div>
</div>
